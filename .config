#
# OpenWrt/LEDE 瘦AP配置文件（基于ipq40xx平台）
# 适用于轻量级无线接入点（无路由/NAT功能）
#

# ==================== 基础目标配置 ====================
CONFIG_TARGET_ath79=n
CONFIG_TARGET_ipq40xx=y
CONFIG_TARGET_ipq40xx_generic=y
CONFIG_TARGET_ipq40xx_generic_DEVICE_alibaba_ap4220_128m=y  # 适配具体硬件型号
CONFIG_HAS_SUBTARGETS=y
CONFIG_HAS_DEVICES=y

# ==================== 内核配置 ====================
# 基础功能
CONFIG_KERNEL_PRINTK=y
CONFIG_KERNEL_DEBUG_FS=n
CONFIG_KERNEL_IPV6=y
CONFIG_KERNEL_EXT4_FS_SECURITY=y
CONFIG_KERNEL_SECURITY=n
CONFIG_KERNEL_SECURITY_NETWORK=n

# 无线驱动
CONFIG_PACKAGE_kmod-mac80211=y
CONFIG_PACKAGE_kmod-ath10k-ct=y  # Qualcomm Atheros QCA988x/QCA998x驱动
CONFIG_PACKAGE_kmod-cfg80211=y
CONFIG_PACKAGE_kmod-ath=y
CONFIG_PACKAGE_kmod-ath9k-htc=y  # 兼容旧款USB无线网卡

# 硬件支持
CONFIG_PACKAGE_kmod-usb-core=y
CONFIG_PACKAGE_kmod-usb-dwc3=y  # USB3.0控制器
CONFIG_PACKAGE_kmod-usb-xhci-hcd=y
CONFIG_PACKAGE_kmod-leds-gpio=y  # GPIO控制的LED指示灯

# ==================== 无线功能 ====================
# HostAPD（无线接入点服务）
CONFIG_PACKAGE_hostapd=y
CONFIG_PACKAGE_hostapd-common=y
CONFIG_PACKAGE_hostapd-openssl=y  # 使用OpenSSL加密
CONFIG_WPA_ENABLE_WEP=y          # 兼容旧设备（可选）
CONFIG_WPA_MBO_SUPPORT=y         # 802.11v漫游优化
CONFIG_PACKAGE_wpa-supplicant=y  # 客户端模式（用于无线回传场景）

# 无线工具
CONFIG_PACKAGE_iwinfo=y          # 无线信息查询工具
CONFIG_PACKAGE_iw=y              # 无线配置工具

# ==================== 网络服务 ====================
# 仅保留DHCP客户端（瘦AP不提供路由/NAT）
CONFIG_PACKAGE_odhcp6c=y         # IPv6 DHCP客户端
CONFIG_PACKAGE_odhcpd=n          # 禁用DHCP服务器
CONFIG_PACKAGE_dnsmasq=n         # 禁用DNS缓存/DHCP
CONFIG_PACKAGE_firewall4=n       # 禁用防火墙（由上级控制器管理）

# 网络工具
CONFIG_PACKAGE_ip=y              # iproute2工具集
CONFIG_PACKAGE_ip-full=y         # 完整iproute2功能
CONFIG_PACKAGE_ethtool=y         # 以太网工具
CONFIG_PACKAGE_tcpdump-mini=y    # 轻量级抓包工具

# ==================== 系统管理 ====================
# 基础系统
CONFIG_PACKAGE_procd=y           # 进程守护
CONFIG_PACKAGE_ubox=y            # 基础工具库
CONFIG_PACKAGE_ubus=y            # 进程间通信总线
CONFIG_PACKAGE_uci=y             # 统一配置接口

# 调试与监控
CONFIG_PACKAGE_htop=y            # 进程监控
CONFIG_PACKAGE_logread=y         # 日志查看
CONFIG_PACKAGE_nano=y            # 文本编辑器
CONFIG_PACKAGE_busybox=y
CONFIG_BUSYBOX_DEFAULT_FEATURE_VERBOSE_USAGE=y

# 安全加固
CONFIG_PACKAGE_dropbear=n        # 禁用SSH（可选，通过串口管理）
CONFIG_PACKAGE_uhttpd=y          # 轻量级HTTP服务器（用于Web管理）
CONFIG_PACKAGE_luci-mod-admin-full=y  # 完整LuCI管理界面（瘦AP专用）
CONFIG_PACKAGE_luci-mod-network=y     # 网络配置模块
CONFIG_PACKAGE_luci-proto-relay=y     # 无线中继协议支持

# 集成集客AC控制器
CONFIG_PACKAGE_luci-app-gecoosac=y
CONFIG_PACKAGE_luci-i18n-gecoosac-zh-cn=y

# ==================== 存储与文件系统 ====================
CONFIG_PACKAGE_block-mount=y     # 分区挂载工具
CONFIG_PACKAGE_e2fsprogs=y       # ext4文件系统工具
CONFIG_PACKAGE_fdisk=y           # 分区工具
CONFIG_PACKAGE_kmod-fs-ext4=y   # ext4文件系统支持
CONFIG_PACKAGE_kmod-fs-vfat=y   # FAT文件系统支持（用于USB存储）

# ==================== 驱动与硬件支持 ====================
# LED控制
CONFIG_PACKAGE_kmod-led-class=y
CONFIG_PACKAGE_kmod-ledtrig-default-on=y

# 看门狗（可选，增强稳定性）
CONFIG_PACKAGE_kmod-softdog=y
CONFIG_PACKAGE_watchdog=y

# ==================== 瘦AP专项优化 ====================
# 禁用非必要服务
CONFIG_PACKAGE_samba36-server=n
CONFIG_PACKAGE_nginx=n
CONFIG_PACKAGE_vsftpd=n
CONFIG_PACKAGE_nftables=n
CONFIG_PACKAGE_qos-scripts=n

# 精简内核模块
CONFIG_KERNEL_MPTCP=n
CONFIG_KERNEL_BRIDGE=n
CONFIG_KERNEL_NETFILTER=n
CONFIG_KERNEL_NETFILTER_XT_MATCH_COMMENT=n
CONFIG_KERNEL_NETFILTER_XT_MATCH_CONNTRACK=n

# ==================== 固件定制 ====================
CONFIG_TARGET_IMAGES_GZIP=y      # 压缩固件
CONFIG_TARGET_ROOTFS_INITRAMFS=n
CONFIG_TARGET_ROOTFS_EXT4FS=y    # 使用ext4文件系统
